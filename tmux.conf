# tmux.conf
# Simon Swanson

####
#### 


#clear all bindings so I can make my own
unbind -a

# set my prefixes
set -g   prefix C-u
bind C-u send-prefix
bind :   command-prompt

# pane selection
bind h selectp -L
bind j selectp -D
bind k selectp -U
bind l selectp -R

# until I get C-` as a valid key I won't be implementing the following
# bind ` selectp -l
# bind C-` selectw -l

# window selection
# window commands try to be the same as pane commands, just including control
bind C-h selectw -p
bind C-l selectw -n
bind C-s command-prompt -p "Switch to window:" "selectw -t '%1'"
bind 1   selectw -t 1
bind 2   selectw -t 2
bind 3   selectw -t 3
bind 4   selectw -t 4
bind 5   selectw -t 5
bind 6   selectw -t 6
bind 7   selectw -t 7
bind 8   selectw -t 8
bind 9   selectw -t 9
bind 0   selectw -t 10

# pane splitting and unsplitting
# "smart" splitting calibrated for 14 point Menlo font on a 16:10 display - do some math to figure out your numbers
bind - splitw
bind | splitw  -h
bind b breakp
bind m command-prompt -p "Open new pane with command:" "if \"[[ 0 -gt $((8*#{pane_width}-18*#{pane_height})) ]]\" \"splitw -c '#{pane_current_path}' '%1'\" \"splitw -h -c '#{pane_current_path}' '%1'\""
bind n if                "[[ 0 -gt $((8*#{pane_width}-18*#{pane_height})) ]]" "splitw -c '#{pane_current_path}'" "splitw -h -c '#{pane_current_path}'"
bind w confirm -p        "Close pane #P? (y/n)" killp

# manage windows
bind <   swapw -t -1
bind >   swapw -t +1
bind C-m command-prompt -p "New window with command:" "neww '%1'"
bind C-n neww
bind C-w confirm        -p 'Close window "#W"? (y/n)' killw
bind C-r command-prompt -p 'Rename window "#W":'      "renamew '%1'"

# session management
bind d detach
bind D detach -a

# copy-paste mechanisms that interact with the system clipboard while keeping tmux buffers empty
bind            o   copy-mode -e
bind -t vi-copy v   begin-selection
bind -t vi-copy C-v rectangle-toggle
bind -t vi-copy y   copy-pipe        "pbcopy && tmux deleteb"

# avoid copy-mode in alternate screens like vim or less
bind -n         PPage         if -F     "#{alternate_on}" "send PPage" "copy-mode -e; send PPage"
bind -n         WheelDownPane if -F -t= "#{alternate_on}" "send -M"    "selectp -t=; copy-mode -e; send -M"
bind -n         WheelUpPane   if -F -t= "#{alternate_on}" "send -M"    "selectp -t=; copy-mode -e; send -M"
bind -t vi-copy NPage         page-down
bind -t vi-copy PPage         page-up
bind -t vi-copy WheelDownPane scroll-down
bind -t vi-copy WheelUpPane   scroll-up

####
####

# opens tmux with native clipboard and application support and reasonable terminal settings
set -g    default-command   "reattach-to-user-namespace -l bash"
set -g    default-terminal  "screen-256color"
set -g    history-limit     30000
set -g -q mouse             on
set -g    set-titles        on
set -g    set-titles-string "Yes, Master?"

# vi > emacs
setw -g mode-keys   vi
set  -g status-keys vi

# status bar configuration
set  -g message-command-style         fg=brightblack,bg=white
set  -g message-style                 fg=brightblack,bg=white
setw -g monitor-activity              on
set  -g status                        on
set  -g status-interval               1
set  -g status-justify                left
set  -g status-left                   "[#S] "
set  -g status-left-length            20
set  -g status-position               bottom
set  -g status-right                  "[#h]"
set  -g status-right-length           30
set  -g status-style                  fg=cyan,bg=brightblack
set  -g visual-activity               off
setw -g window-status-activity-attr   none
setw -g window-status-current-format  "[#W]"
setw -g window-status-current-style   fg=brightmagenta
setw -g window-status-format          "(#W#F)"
setw -g window-status-style           fg=magenta

# window sanity settings
setw -g aggressive-resize off
set  -g base-index        1
set  -g bell-action       any
setw -g pane-base-index   1
set  -g renumber-windows  on

# command timeouts
set -sg escape-time 0
set -g  repeat-time 0

