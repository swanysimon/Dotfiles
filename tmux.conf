# tmux.conf
# Simon Swanson
# I take no reponsibility for you harming yourself or your computer trying to use this configuration file

# prefix to CTRL-U
set-option -g prefix C-u
bind-key C-u send-prefix
bind-key : command-prompt
bind-key ? list-keys

####
#### panes
####

# pane navigation
bind-key -r h select-pane -L
bind-key -r j select-pane -D
bind-key -r k select-pane -U
bind-key -r l select-pane -R
bind-key -r r rotate-window -D
bind-key -r R rotate-window -U
bind-key -r h select-pane -L
bind-key -r j select-pane -D
bind-key -r k select-pane -U
bind-key -r l select-pane -R

# pane modification
bind-key b break-pane
bind-key s run-shell "~/.tmux_scripts/tmux_split_pane.sh --smart"
bind-key C-s command-prompt -p "Open new pane with command:" "run-shell \"~/.tmux_scripts/tmux_split_pane.sh --smart '%1'\""
bind-key C-x confirm-before -p "Close pane #P? (y/n)" kill-pane
bind-key - run-shell "~/.tmux_scripts/tmux_split_pane.sh --horizontal"
bind-key | run-shell "~/.tmux_scripts/tmux_split_pane.sh --vertical"

####
#### windows
####

# window navigation
bind-key ` select-window -l
bind-key '#' command-prompt -p "Switch to window:" "select-window"
bind-key -r [ select-window -p
bind-key -r ] select-window -n
bind-key -n M-[ select-window -p
bind-key -n M-] select-window -n

# window modifications
bind-key n new-window
bind-key C-n command-prompt -p "New window with command:" "new-window '%1'"
bind-key C-r command-prompt -p 'Rename window "#W":' "rename-window '%%'"
bind-key C-w confirm-before -p 'Close window "#W"? (y/n)' kill-window
bind-key -r < swap-window -t:-1
bind-key -r > swap-window -t:+1

####
#### sessions
####

# TODO: good way of prompting new session and session switch
bind-key d detach-client
bind-key C-q confirm-before -p 'Quit session "#S"? (y/n)' kill-session
bind-key -r { switch-client -p
bind-key -r } switch-client -n

####
#### copy-mode
####

bind-key / copy-mode

# vi > emacs
set-option -s set-clipboard off
set-option -g status-keys vi
set-window-option -g mode-keys vi

# copy to/from the clipboard
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi V send-keys -X select-line
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y run-shell -b "~/.tmux_scripts/tmux_copy_paste.sh copy in-place"
bind-key -T copy-mode-vi Enter run-shell -b "~/.tmux_scripts/tmux_copy_paste.sh copy in-place"
bind-key -T copy-mode-vi MouseDown1Pane send-keys -X clear-selection
bind-key -T copy-mode-vi MouseDragEnd1Pane run-shell -b "~/.tmux_scripts/tmux_copy_paste.sh copy in-place"

# page up/down navigate copy mode
bind-key -n PPage if-shell -F "#{alternate_on}" "send-keys PPage" "copy-mode -eu"
#bind-key -t vi-choice NPage page-down
#bind-key -t vi-choice PPage page-up

####
#### mouse
####

set-window-option -g mouse on

####
#### terminal
####

# opens tmux with native clipboard and application support
set-option -g history-limit 30000

# window sanity settings
set-option -g base-index 1
set-option -g bell-action any
set-option -g default-terminal "xterm-256color"
set-option -g renumber-windows on
set-window-option -g aggressive-resize off
set-window-option -g pane-base-index 1

# command timeouts
set-option -sg escape-time 0
set-option -g repeat-time 250

####
#### status bar
####

# status bar configuration
set-option -g message-command-style fg=black,bg=white
set-option -g message-style fg=black,bg=white
set-option -g status on
set-option -g status-interval 1
set-option -g status-justify left
set-option -g status-left "[#S] "
set-option -g status-left-length 100
set-option -g status-position bottom
set-option -g status-right "[#h]"
set-option -g status-right-length 100
set-option -g status-style fg=red
set-option -g visual-activity off
set-window-option -g monitor-activity off
set-window-option -g window-status-activity-style fg=cyan
# active window shows you the window name and (if different from window name) the running process
set-window-option -g window-status-current-format "[#W#{?#{==:#W,#{pane_current_command}},, #{pane_current_command}}]"
set-window-option -g window-status-current-style fg=yellow
# window shows you the window index, window name, activity flags, and (if different from window name) the running process
set-window-option -g window-status-format "(#I:#W#F#{?#{==:#W,#{pane_current_command}},, #{pane_current_command}})"
set-window-option -g window-status-style fg=magenta

